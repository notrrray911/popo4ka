{% extends "base.html" %}

{% block title %}–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂ - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–¥–µ–π –¥–ª—è —Ö–æ–±–±–∏{% endblock %}

{% block content %}
<div class="challenge-page">
    <h1>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂</h1>
    <p class="page-description">–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ –ø–æ–±–µ–∂–¥–∞–π—Ç–µ –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏—é!</p>

    {% if challenge %}
    <div class="challenge-card">
        <div class="challenge-header">
            <h2>–ó–∞–¥–∞–Ω–∏–µ –Ω–∞ {{ challenge.date }}</h2>
            <span class="challenge-badge">
                <i class="fas fa-trophy"></i> –î–µ–Ω—å {{ challenge.id }}
            </span>
        </div>

        <div class="challenge-idea">
            <h3>{{ challenge.idea.title }}</h3>
            <p class="challenge-description">{{ challenge.idea.description }}</p>

            <div class="idea-meta">
                <span class="meta-item"><i class="fas fa-clock"></i>
                    {% if challenge.idea.time_required == 'short' %}–î–æ 1 —á–∞—Å–∞
                    {% elif challenge.idea.time_required == 'medium' %}1-3 —á–∞—Å–∞
                    {% elif challenge.idea.time_required == 'long' %}–ë–æ–ª–µ–µ 3 —á–∞—Å–æ–≤
                    {% else %}{{ challenge.idea.time_required }}{% endif %}
                </span>
                <span class="meta-item"><i class="fas fa-wallet"></i>
                    {% if challenge.idea.budget == 'free' %}–ë–µ—Å–ø–ª–∞—Ç–Ω–æ
                    {% elif challenge.idea.budget == 'low' %}–ù–∏–∑–∫–∏–π
                    {% elif challenge.idea.budget == 'medium' %}–°—Ä–µ–¥–Ω–∏–π
                    {% elif challenge.idea.budget == 'high' %}–í—ã—Å–æ–∫–∏–π
                    {% else %}{{ challenge.idea.budget }}{% endif %}
                </span>
                <span class="meta-item"><i class="fas fa-map-marker-alt"></i>
                    {% if challenge.idea.location == 'indoor' %}–î–æ–º–∞
                    {% elif challenge.idea.location == 'outdoor' %}–ù–∞ —É–ª–∏—Ü–µ
                    {% elif challenge.idea.location == 'both' %}–õ—é–±–æ–µ
                    {% else %}{{ challenge.idea.location }}{% endif %}
                </span>
                <span class="meta-item"><i class="fas fa-signal"></i>
                    {% if challenge.idea.difficulty == 'easy' %}–õ–µ–≥–∫–∞—è
                    {% elif challenge.idea.difficulty == 'medium' %}–°—Ä–µ–¥–Ω—è—è
                    {% elif challenge.idea.difficulty == 'hard' %}–°–ª–æ–∂–Ω–∞—è
                    {% else %}{{ challenge.idea.difficulty }}{% endif %}
                </span>
            </div>
        </div>

        <div class="challenge-stats">
            <div class="stat-item">
                <i class="fas fa-users"></i>
                <div>
                    <h4>–í—ã–ø–æ–ª–Ω–∏–ª–∏ —Å–µ–≥–æ–¥–Ω—è</h4>
                    <p class="stat-number">{{ challenge.completed_count }} —á–µ–ª–æ–≤–µ–∫</p>
                </div>
            </div>
            <div class="stat-item">
                <i class="fas fa-calendar-alt"></i>
                <div>
                    <h4>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è</h4>
                    <p class="countdown" id="countdown">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                </div>
            </div>
        </div>

        <div class="challenge-actions">
            <button onclick="completeChallenge({{ challenge.id }})" class="btn-primary btn-large">
                <i class="fas fa-check-circle"></i> –Ø –≤—ã–ø–æ–ª–Ω–∏–ª —á–µ–ª–ª–µ–Ω–¥–∂!
            </button>
            <button onclick="suggestAlternative()" class="btn-secondary" id="alternative-btn">
                <i class="fas fa-redo"></i> –î—Ä—É–≥–æ–µ –∑–∞–¥–∞–Ω–∏–µ
            </button>
            <button onclick="shareChallenge()" class="btn-action">
                <i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
            </button>
        </div>

        <div class="challenge-tips">
            <h4><i class="fas fa-lightbulb"></i> –°–æ–≤–µ—Ç—ã –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é:</h4>
            <ul>
                <li>–í—ã–¥–µ–ª–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
                <li>–ù–µ —Å—Ç—Ä–µ–º–∏—Ç–µ—Å—å –∫ –∏–¥–µ–∞–ª—É - –≥–ª–∞–≤–Ω–æ–µ –Ω–∞—á–∞—Ç—å</li>
                <li>–°–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞ –ø–∞–º—è—Ç—å</li>
                <li>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏</li>
            </ul>
        </div>
    </div>
    {% else %}
    <div class="no-challenge">
        <i class="fas fa-calendar-plus fa-3x"></i>
        <h3>–ß–µ–ª–ª–µ–Ω–¥–∂ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–π—Ç–∏ —á—É—Ç—å –ø–æ–∑–∂–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂!</p>
        <div class="challenge-actions">
            <a href="{{ url_for('generate_idea') }}" class="btn-primary">
                <i class="fas fa-random"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ—é
            </a>
            <a href="{{ url_for('add_idea') }}" class="btn-secondary">
                <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é –∏–¥–µ—é
            </a>
        </div>
    </div>
    {% endif %}

    <div class="previous-challenges">
        <h3><i class="fas fa-history"></i> –ü—Ä–µ–¥—ã–¥—É—â–∏–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏</h3>
        <div class="challenges-list">
            <div class="challenge-history-item">
                <div class="history-date">–í—á–µ—Ä–∞</div>
                <div class="history-title">–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∞–∫–≤–∞—Ä–µ–ª—å–Ω—ã–π –ø–µ–π–∑–∞–∂</div>
                <div class="history-stats">
                    <span><i class="fas fa-users"></i> 8 —á–µ–ª–æ–≤–µ–∫ –≤—ã–ø–æ–ª–Ω–∏–ª–∏</span>
                </div>
            </div>
            <div class="challenge-history-item">
                <div class="history-date">2 –¥–Ω—è –Ω–∞–∑–∞–¥</div>
                <div class="history-title">–ò–∑—É—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤ –∫–∞–ª–ª–∏–≥—Ä–∞—Ñ–∏–∏</div>
                <div class="history-stats">
                    <span><i class="fas fa-users"></i> 12 —á–µ–ª–æ–≤–µ–∫ –≤—ã–ø–æ–ª–Ω–∏–ª–∏</span>
                </div>
            </div>
        </div>
        <p class="dev-note"><em>–ò—Å—Ç–æ—Ä–∏—è —á–µ–ª–ª–µ–Ω–¥–∂–µ–π –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ</em></p>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã -->
<div class="modal-overlay" id="alternative-modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-lightbulb"></i> –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="alternative-idea" id="alternative-content">
                <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∏–¥–µ—è -->
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è...
                </div>
            </div>
            <div class="modal-actions">
                <button onclick="acceptAlternative()" class="btn-primary">
                    <i class="fas fa-check"></i> –ü—Ä–∏–Ω—è—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ
                </button>
                <button onclick="suggestAlternative()" class="btn-secondary">
                    <i class="fas fa-redo"></i> –î—Ä—É–≥–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                </button>
                <button onclick="closeModal()" class="btn-action">
                    <i class="fas fa-times"></i> –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–µ–∫—É—â–µ–º—É
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // –¢–∞–π–º–µ—Ä –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
    function updateCountdown() {
        const now = new Date();
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(0, 0, 0, 0);

        const diff = tomorrow - now;

        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        const countdownElement = document.getElementById('countdown');
        if (countdownElement) {
            countdownElement.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
    setInterval(updateCountdown, 1000);
    updateCountdown(); // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤

    // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —á–µ–ª–ª–µ–Ω–¥–∂–∞
    function completeChallenge(challengeId) {
        const button = document.querySelector('.challenge-actions .btn-primary');
        const originalText = button.innerHTML;

        button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –û—Ç–ø—Ä–∞–≤–∫–∞...';
        button.disabled = true;

        fetch(`/complete_challenge/${challengeId}`, { method: 'POST' })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
                    const statElement = document.querySelector('.stat-number');
                    if (statElement) {
                        statElement.textContent = `${data.completed_count} —á–µ–ª–æ–≤–µ–∫`;
                    }

                    // –ú–µ–Ω—è–µ–º –∫–Ω–æ–ø–∫—É
                    button.innerHTML = '<i class="fas fa-check-double"></i> –í—ã–ø–æ–ª–Ω–µ–Ω–æ!';
                    button.classList.remove('btn-primary');
                    button.classList.add('btn-success');
                    button.disabled = true;

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    showNotification('üéâ –û—Ç–ª–∏—á–Ω–æ! –ß–µ–ª–ª–µ–Ω–¥–∂ –≤—ã–ø–æ–ª–Ω–µ–Ω!',
                        '–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω. –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞–≤—Ç—Ä–∞ –∑–∞ –Ω–æ–≤—ã–º –∑–∞–¥–∞–Ω–∏–µ–º!', 'success');
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                button.innerHTML = originalText;
                button.disabled = false;
                showNotification('‚ùå –û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.', 'error');
            });
    }

    // –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
    function suggestAlternative() {
        const button = document.getElementById('alternative-btn');
        const originalText = button.innerHTML;

        button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ò—â–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É...';
        button.disabled = true;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        showNotification('üîç –ò—â–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ...',
            '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ...', 'info', 2000);

        // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∏–¥–µ—é —Å —Å–µ—Ä–≤–µ—Ä–∞
        fetch('/api/generate_idea', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ filters: {} })
        })
        .then(response => response.json())
        .then(data => {
            button.innerHTML = originalText;
            button.disabled = false;

            if (data.success) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π
                showAlternativeModal(data.idea);
            } else {
                showNotification('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É',
                    '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é –∏–¥–µ—é –≤ —Ä–∞–∑–¥–µ–ª–µ "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä"', 'error');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
            button.innerHTML = originalText;
            button.disabled = false;
            showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è',
                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞', 'error');
        });
    }

    // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π
    function showAlternativeModal(idea) {
        const modal = document.getElementById('alternative-modal');
        const content = document.getElementById('alternative-content');

        // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–¥–µ–∏
        const timeLabels = {
            'short': '–î–æ 1 —á–∞—Å–∞',
            'medium': '1-3 —á–∞—Å–∞',
            'long': '–ë–æ–ª–µ–µ 3 —á–∞—Å–æ–≤'
        };

        const budgetLabels = {
            'free': '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ',
            'low': '–ù–∏–∑–∫–∏–π',
            'medium': '–°—Ä–µ–¥–Ω–∏–π',
            'high': '–í—ã—Å–æ–∫–∏–π'
        };

        const locationLabels = {
            'indoor': '–î–æ–º–∞',
            'outdoor': '–ù–∞ —É–ª–∏—Ü–µ',
            'both': '–õ—é–±–æ–µ'
        };

        const difficultyLabels = {
            'easy': '–õ–µ–≥–∫–∞—è',
            'medium': '–°—Ä–µ–¥–Ω—è—è',
            'hard': '–°–ª–æ–∂–Ω–∞—è'
        };

        content.innerHTML = `
            <div class="alternative-card">
                <div class="alternative-category">${idea.category}</div>
                <h4>${idea.title}</h4>
                <p class="alternative-description">${idea.description}</p>
                <div class="alternative-meta">
                    <span><i class="fas fa-clock"></i> ${timeLabels[idea.time_required] || idea.time_required}</span>
                    <span><i class="fas fa-wallet"></i> ${budgetLabels[idea.budget] || idea.budget}</span>
                    <span><i class="fas fa-map-marker-alt"></i> ${locationLabels[idea.location] || idea.location}</span>
                    <span><i class="fas fa-signal"></i> ${difficultyLabels[idea.difficulty] || idea.difficulty}</span>
                </div>
                <div class="alternative-stats">
                    <span class="votes"><i class="fas fa-heart"></i> ${idea.votes} –≥–æ–ª–æ—Å–æ–≤</span>
                    <span class="date"><i class="fas fa-calendar"></i> ${idea.created_at}</span>
                </div>
            </div>
        `;

        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        showNotification('‚ú® –ù–∞—à–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É!',
            '–û—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º –∑–∞–¥–∞–Ω–∏–µ–º', 'success');
    }

    // –ü—Ä–∏–Ω—è—Ç–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
    function acceptAlternative() {
        const content = document.getElementById('alternative-content');
        const title = content.querySelector('h4')?.textContent || '–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ';

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        closeModal();

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ!',
            `–í—ã –≤—ã–±—Ä–∞–ª–∏: "${title}". –£–¥–∞—á–∏ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏!`, 'success');

        // –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —á–µ–ª–ª–µ–Ω–¥–∂ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        // –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å API endpoint –¥–ª—è —Å–º–µ–Ω—ã —á–µ–ª–ª–µ–Ω–¥–∂–∞
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    function closeModal() {
        const modal = document.getElementById('alternative-modal');
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ–ª–ª–µ–Ω–¥–∂–µ–º
    function shareChallenge() {
        const challengeTitle = document.querySelector('.challenge-idea h3').textContent;
        const text = `–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É —á–µ–ª–ª–µ–Ω–¥–∂—É: "${challengeTitle}"`;
        const url = window.location.href;

        if (navigator.share) {
            navigator.share({
                title: '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂',
                text: text,
                url: url
            }).then(() => {
                showNotification('üì§ –£—Å–ø–µ—à–Ω–æ!', '–í—ã –ø–æ–¥–µ–ª–∏–ª–∏—Å—å —á–µ–ª–ª–µ–Ω–¥–∂–µ–º', 'success');
            });
        } else {
            navigator.clipboard.writeText(`${text}\n${url}`).then(() => {
                showNotification('üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!',
                    '–°—Å—ã–ª–∫–∞ –Ω–∞ —á–µ–ª–ª–µ–Ω–¥–∂ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
            });
        }
    }

    // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(title, message, type = 'info', duration = 4000) {
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;

        const icons = {
            'success': 'fa-check-circle',
            'error': 'fa-exclamation-circle',
            'info': 'fa-info-circle',
            'warning': 'fa-exclamation-triangle'
        };

        notification.innerHTML = `
            <div class="notification-icon">
                <i class="fas ${icons[type] || 'fa-info-circle'}"></i>
            </div>
            <div class="notification-content">
                <h4>${title}</h4>
                <p>${message}</p>
            </div>
            <button class="notification-close" onclick="this.parentElement.remove()">
                <i class="fas fa-times"></i>
            </button>
        `;

        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        document.body.appendChild(notification);

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
        if (duration > 0) {
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, duration);
        }
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
    document.addEventListener('click', function(event) {
        const modal = document.getElementById('alternative-modal');
        if (event.target === modal) {
            closeModal();
        }
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Escape
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeModal();
        }
    });
</script>
{% endblock %}